# 安装和使用说明

## 一、快速安装（3步搞定）

### 第1步：安装依赖
双击运行：
```
install_deps.bat
```

这会自动安装所有必需的Python库（约3-5分钟）。

### 第2步：测试系统
双击运行：
```
run_test.bat
```

确保所有测试通过（显示绿色的 ✓）。

### 第3步：开始使用
双击运行：
```
run_gui.bat
```

启动图形界面，按提示操作即可。

---

## 二、详细说明

### 环境要求
- **操作系统**：Windows 10/11
- **Python版本**：3.10 或更高（3.10、3.11、3.12 都可以）
- **硬盘空间**：至少 500MB 可用空间
- **内存**：建议 2GB 以上

### 如何检查Python版本
打开命令提示符（cmd），输入：
```bash
python --version
```

如果显示以下任一版本，都符合要求：
- ✅ `Python 3.10.x`
- ✅ `Python 3.11.x`
- ✅ `Python 3.12.x`
- ✅ `Python 3.13.x` 及以上（通常也兼容）

如果没有Python或版本过低，请前往官网下载：
https://www.python.org/downloads/

### 批处理文件说明

| 文件名 | 功能 | 使用场景 |
|--------|------|----------|
| `install_deps.bat` | 安装所有依赖库 | 第一次使用前必须运行 |
| `run_gui.bat` | 启动图形界面 | 新手推荐，可视化操作 |
| `run_test.bat` | 运行系统测试 | 验证安装是否成功 |

### 中文编码问题

如果bat文件运行时中文显示乱码：

**方法1：修改控制台编码**
1. 右键点击命令提示符标题栏
2. 选择"属性"
3. 在"选项"标签下，勾选"使用旧版控制台"
4. 重启命令提示符

**方法2：使用PowerShell**
1. 在文件夹空白处按住Shift，右键
2. 选择"在此处打开PowerShell窗口"
3. 运行命令：`./install_deps.bat`

**方法3：使用Windows Terminal**
下载并使用Windows Terminal（推荐），完美支持UTF-8。

---

## 三、使用方式

### 方式A：图形界面（推荐新手）

1. 双击 `run_gui.bat`
2. 点击"浏览"选择语料文件（Excel或CSV）
3. 输入自定义维度（如：老师,教学）
4. 选择分析类型（请求/反馈/双场景）
5. 点击"开始分析"
6. 等待完成，查看输出目录的报告

### 方式B：命令行（推荐高级用户）

打开命令提示符（cmd），进入项目目录，运行：

```bash
# 基础用法
python src/main.py 语料文件.xlsx --dimensions "老师,教学"

# 指定分析类型
python src/main.py 语料文件.xlsx -d "老师,教学" -t both

# 自定义输出目录
python src/main.py 语料文件.xlsx -d "老师,教学" -o 我的分析结果

# 查看所有参数
python src/main.py --help
```

### 参数说明

| 参数 | 简写 | 说明 | 示例 |
|------|------|------|------|
| 文件路径 | - | 语料文件（必需） | `data.xlsx` |
| --dimensions | -d | 自定义维度（必需） | `"老师,教学"` |
| --type | -t | 分析类型 | `both` / `request` / `feedback` |
| --output | -o | 输出目录 | `output` |
| --config | -c | 配置文件路径 | `config.json` |

---

## 四、语料文件格式

### Excel/CSV文件要求

**必需列**：
- `content`：语料内容（必需）

**可选列**：
- `type`：语料类型（"请求"或"反馈"）
- `time`：时间戳
- 其他自定义列

### 示例数据

| content | type |
|---------|------|
| 希望PPT模板适合老师上课使用，简洁一点 | 请求 |
| 能否增加教学案例展示的模块？ | 请求 |
| 老师反馈说操作太复杂，不适合课堂演示 | 反馈 |
| 教学PPT的页数能控制在10-15页吗？ | 请求 |

完整示例请查看：`SAMPLE_DATA.md`

---

## 五、输出结果

分析完成后，在输出目录（默认`output/`）会生成：

### 1. Markdown报告
```
PPT语料分析报告_老师,教学_20251201_120000.md
```
- 核心分析结论
- 数据表格
- 图表引用

### 2. Excel报告
```
PPT语料分析报告_老师,教学_20251201_120000.xlsx
```
- 数据概览（Sheet 1）
- 请求分析（Sheet 2）
- 反馈分析（Sheet 3）

### 3. 可视化图表
```
charts/
├── 老师_教学_请求_总体词频.png
├── 老师_教学_请求_维度词频.png
├── 老师_教学_请求_情感分布.png
├── 老师_教学_反馈_总体词频.png
├── 老师_教学_反馈_维度词频.png
└── 老师_教学_反馈_情感分布.png
```

---

## 六、常见问题

### Q1：运行bat文件时闪退
**原因**：可能是Python未安装或路径配置问题
**解决**：
1. 检查Python是否安装：`python --version`
2. 确保Python已添加到系统PATH
3. 右键bat文件 → "编辑"，检查命令是否正确

### Q2：提示"No module named xxx"
**原因**：依赖未安装
**解决**：运行 `install_deps.bat` 重新安装依赖

### Q3：分析时提示"文件不存在"
**原因**：文件路径错误
**解决**：
1. 使用绝对路径，如：`C:\Users\xxx\data.xlsx`
2. 或将语料文件放在项目根目录

### Q4：分析结果为空
**原因**：语料与自定义维度不匹配
**解决**：
1. 检查维度关键词是否在语料中出现
2. 查看同义词词典（`src/config/synonym_dict.txt`），添加相关同义词

### Q5：中文显示乱码
**解决**：参考上面"中文编码问题"部分

---

## 七、自定义配置

### 1. PPT业务词典
编辑 `src/config/ppt_business_dict.txt`，一行一个术语：
```
PPT主题
演示文稿
课堂演示
```

### 2. 同义词词典
编辑 `src/config/synonym_dict.txt`，格式：主词=同义词1,同义词2
```
老师=教师,教员,讲师
教学=授课,讲课,上课
```

### 3. 停用词
编辑 `src/config/stopwords.txt`，一行一个无意义词：
```
的
了
在
```

### 4. 分析参数
编辑 `src/config/config.json`：
```json
{
  "preprocess": {
    "custom_dimension_weight_multiplier": 3.0  // 维度权重倍数
  }
}
```

---

## 八、获取帮助

- **完整文档**：查看 `README.md`
- **快速入门**：查看 `QUICKSTART.md`
- **打包说明**：查看 `BUILD.md`
- **实现总结**：查看 `PROJECT_SUMMARY.md`

---

**版本**：v1.0.0  
**更新日期**：2025-12-01  
**适用平台**：Windows 10/11

